<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Believe - Admin Dashboard</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    .admin-wrap {
      max-width: 1100px;
      margin: 20px auto;
      padding: 0 18px 40px;
    }

    .admin-header {
      margin-bottom: 16px;
    }

    .admin-header h2 {
      margin-bottom: 4px;
    }

    .admin-header p {
      font-size: 14px;
      color: #555;
    }

    .admin-summary {
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
      margin-bottom: 18px;
    }

    .admin-card {
      flex: 1 1 180px;
      min-width: 180px;
      background: #fff;
      padding: 12px 14px;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }

    .admin-card h3 {
      font-size: 14px;
      margin-bottom: 4px;
      color: #666;
    }

    .admin-card strong {
      font-size: 20px;
      color: #1656a2;
    }

    .admin-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
      margin-top: 10px;
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }

    .admin-table th,
    .admin-table td {
      border: 1px solid #eee;
      padding: 8px 10px;
      text-align: left;
    }

    .admin-table th {
      background: #f7f9fc;
    }

    .badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
    }

    .badge-approved {
      background: #e6f7e9;
      color: #1f7a34;
    }

    .badge-pending {
      background: #fff7e6;
      color: #b26b00;
    }

    .badge-rejected {
      background: #ffe6e6;
      color: #b21f1f;
    }

    .btn-small {
      padding: 4px 10px;
      font-size: 12px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      background: #1656a2;
      color: #fff;
    }

    .btn-small:hover {
      background: #0e3e76;
    }

    .btn-small.secondary {
      background: #888;
    }

    .btn-small.secondary:hover {
      background: #666;
    }

    .top-bar-admin {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 22px;
      background: #ffffff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .top-bar-admin .brand {
      font-size: 24px;
      font-weight: bold;
      color: #1656a2;
      text-decoration: none;
    }

    .top-bar-admin .right {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 13px;
    }

    .top-bar-admin .logout-btn {
      background: #1656a2;
      color: white;
      border: none;
      padding: 6px 12px;
      font-size: 13px;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.2s;
    }

    .top-bar-admin .logout-btn:hover {
      background: #0e3e76;
    }
  </style>
</head>
<body>
  <!-- Simple admin top bar -->
  <header class="top-bar-admin">
    <a href="index.html" class="brand">Believe</a>
    <div class="right">
      <span>Role: Admin (demo)</span>
      <button class="logout-btn" id="adminLogoutBtn">Logout</button>
    </div>
  </header>

  <main class="admin-wrap">
    <section class="admin-header">
      <h2>Admin Dashboard â€“ NGO Approvals</h2>
      <p>Review newly registered NGOs and approve them before they can submit projects or receive donations.</p>
    </section>

    <!-- Summary cards -->
    <section class="admin-summary">
      <div class="admin-card">
        <h3>Total NGOs</h3>
        <strong id="totalNgos">0</strong>
      </div>
      <div class="admin-card">
        <h3>Approved NGOs</h3>
        <strong id="approvedNgos">0</strong>
      </div>
      <div class="admin-card">
        <h3>Pending NGOs</h3>
        <strong id="pendingNgos">0</strong>
      </div>
    </section>

    <!-- NGO list table -->
    <section>
      <h3>NGO Accounts</h3>
      <table class="admin-table">
        <thead>
          <tr>
            <th>NGO Name</th>
            <th>Email</th>
            <th>Status</th>
            <th>Actions (demo)</th>
          </tr>
        </thead>
        <tbody id="ngoTableBody">
          <tr>
            <td colspan="4">No NGO accounts found.</td>
          </tr>
        </tbody>
      </table>
      <p style="font-size:13px;color:#666;margin-top:8px;">
        Note: This is a frontend-only demo using <code>localStorage["demoUsers"]</code>. In the PHP/MySQL phase, this screen will read from the real database.
      </p>
    </section>
  </main>

  <script>
    // Simple "logout" for demo: clear session and go back to login
    document.getElementById('adminLogoutBtn').onclick = () => {
      localStorage.removeItem('demoSession');
      window.location.href = 'login.html';
    };

    function loadNgoListForAdmin() {
      const tbody = document.getElementById('ngoTableBody');

      let users = [];
      try {
        users = JSON.parse(localStorage.getItem('demoUsers') || '[]');
      } catch (e) {
        users = [];
      }

      // Filter NGOs only
      const ngos = users.filter(u => u.role === 'ngo');

      // Summary counts
      const total = ngos.length;
      const approved = ngos.filter(u => (u.status || 'pending') === 'approved').length;
      const pending = ngos.filter(u => (u.status || 'pending') === 'pending').length;

      document.getElementById('totalNgos').textContent = total;
      document.getElementById('approvedNgos').textContent = approved;
      document.getElementById('pendingNgos').textContent = pending;

      // Table
      tbody.innerHTML = '';

      if (ngos.length === 0) {
        const tr = document.createElement('tr');
        const td = document.createElement('td');
        td.colSpan = 4;
        td.textContent = 'No NGO accounts found yet. Ask an NGO to sign up from the Login page.';
        tr.appendChild(td);
        tbody.appendChild(tr);
        return;
      }

      ngos.forEach((ngo, index) => {
        const tr = document.createElement('tr');

        const nameTd = document.createElement('td');
        nameTd.textContent = ngo.name || '(no name)';

        const emailTd = document.createElement('td');
        emailTd.textContent = ngo.email || '';

        const statusTd = document.createElement('td');
        const statusSpan = document.createElement('span');
        const status = ngo.status || 'pending';

        statusSpan.classList.add('badge');
        if (status === 'approved') {
          statusSpan.classList.add('badge-approved');
          statusSpan.textContent = 'Approved';
        } else if (status === 'rejected') {
          statusSpan.classList.add('badge-rejected');
          statusSpan.textContent = 'Rejected';
        } else {
          statusSpan.classList.add('badge-pending');
          statusSpan.textContent = 'Pending';
        }
        statusTd.appendChild(statusSpan);

        const actionsTd = document.createElement('td');

        // Approve button
        const approveBtn = document.createElement('button');
        approveBtn.textContent = 'Approve';
        approveBtn.className = 'btn-small';
        approveBtn.disabled = (status === 'approved');
        approveBtn.onclick = () => {
          updateNgoStatus(ngo.email, 'approved');
        };
        actionsTd.appendChild(approveBtn);

        // Optional reject button (demo only)
        const rejectBtn = document.createElement('button');
        rejectBtn.textContent = 'Reject';
        rejectBtn.className = 'btn-small secondary';
        rejectBtn.style.marginLeft = '6px';
        rejectBtn.onclick = () => {
          updateNgoStatus(ngo.email, 'rejected');
        };
        actionsTd.appendChild(rejectBtn);

        tr.appendChild(nameTd);
        tr.appendChild(emailTd);
        tr.appendChild(statusTd);
        tr.appendChild(actionsTd);

        tbody.appendChild(tr);
      });
    }

    function updateNgoStatus(email, newStatus) {
      let users = [];
      try {
        users = JSON.parse(localStorage.getItem('demoUsers') || '[]');
      } catch (e) {
        users = [];
      }

      const idx = users.findIndex(u => u.email === email && u.role === 'ngo');
      if (idx === -1) return;

      users[idx].status = newStatus;
      localStorage.setItem('demoUsers', JSON.stringify(users));

      alert('NGO "' + (users[idx].name || email) + '" status updated to: ' + newStatus.toUpperCase());
      loadNgoListForAdmin();
    }

    // Initial load
    loadNgoListForAdmin();
  </script>
</body>
</html>
